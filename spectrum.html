

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>spectrum – Analysis of hyperfine structures &mdash; SATLAS 1.0.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="SATLAS 1.0.0 documentation" href="index.html"/>
        <link rel="next" title="loglikelihood – Calculation of loglikelihood for common distributions" href="loglikelihood.html"/>
        <link rel="prev" title="profiles – Implementation of lineshapes" href="profiles.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> SATLAS</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="utilities.html"><tt class="docutils literal"><span class="pre">utilities</span></tt> &#8211; Collection of handy functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#module-satlas.utilities">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="profiles.html"><tt class="docutils literal"><span class="pre">profiles</span></tt> &#8211; Implementation of lineshapes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="profiles.html#usage-example">Usage example</a></li>
<li class="toctree-l2"><a class="reference internal" href="profiles.html#module-satlas.profiles">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href=""><tt class="docutils literal"><span class="pre">spectrum</span></tt> &#8211; Analysis of hyperfine structures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#usage-examples">Usage examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-satlas.spectrum">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="loglikelihood.html"><tt class="docutils literal"><span class="pre">loglikelihood</span></tt> &#8211; Calculation of loglikelihood for common distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="loglikelihood.html#module-satlas.loglikelihood">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="relaxation.html"><tt class="docutils literal"><span class="pre">relaxation</span></tt> &#8211; Implementation of spin-lattice relaxation algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="relaxation.html#usage-examples">Usage examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="relaxation.html#module-satlas.relaxation">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="polar.html"><tt class="docutils literal"><span class="pre">polar</span></tt> &#8211; Polarization simulations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="polar.html#module-satlas.polar">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="collaps.html"><tt class="docutils literal"><span class="pre">collaps</span></tt> &#8211; API for interfacing with COLLAPS data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="collaps.html#module-collaps">Code documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SATLAS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li><tt class="docutils literal"><span class="pre">spectrum</span></tt> &#8211; Analysis of hyperfine structures</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/spectrum.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="spectrum-analysis-of-hyperfine-structures">
<h1><a class="reference internal" href="#module-spectrum" title="spectrum: Implementation of classes for the analysis of hyperfine structure spectra, including simultaneous fitting, various fitting routines and isomeric presence. (Windows)"><tt class="xref py py-mod docutils literal"><span class="pre">spectrum</span></tt></a> &#8211; Analysis of hyperfine structures<a class="headerlink" href="#spectrum-analysis-of-hyperfine-structures" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#module-spectrum" title="spectrum: Implementation of classes for the analysis of hyperfine structure spectra, including simultaneous fitting, various fitting routines and isomeric presence. (Windows)"><tt class="xref py py-mod docutils literal"><span class="pre">spectrum</span></tt></a> module facilitates the creation of hyperfine structure profiles (usually through the class <tt class="xref py py-class docutils literal"><span class="pre">SingleSpectrum</span></tt>), and the fitting of these profiles to data. Currently, it takes into account the contributions of dipole, quadrupole and octupole moments, and the formula used for the lineshapes can be selected from the module <a class="reference internal" href="profiles.html#module-profiles" title="profiles: Implementation of classes for different lineshapes, creating callables for easy and intuitive calculations. (Windows)"><tt class="xref py py-mod docutils literal"><span class="pre">profiles</span></tt></a>. The hyperfine parameters, as well as the requested frequency, have to be supplied in units of MHz.</p>
<dl class="docutils">
<dt>Also included are routines for fitting the data in two different ways:</dt>
<dd><ul class="first last simple">
<li>Using a least-squares approach (assuming Gaussian errors)</li>
<li>Using a maximum likelihood approach (assuming Poisson errors)</li>
</ul>
</dd>
</dl>
<p>Both of these methods are based on the fact that, for spectroscopic data, the error on the number of counts is Poisson-distributed, which can be approximated for large values by <img class="math" src="_images/math/50ad50e28cb8df4a48967b3a38d4e877901b2d1d.png" alt="\sqrt{N}"/>. A convenience routine is included to introduce the square root as the error, taking care with zero counts.</p>
<p>Furthermore, simultaneous fitting is also possible, through the use of the class <tt class="xref py py-class docutils literal"><span class="pre">CombinedSpectrum</span></tt>, as is the presence of an isomer through the class <tt class="xref py py-class docutils literal"><span class="pre">IsomerSpectrum</span></tt>. The usage examples go through a few of the basic commands for each of these cases.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The fitroutines are quite robust, but are not always convergent. Care has to be taken when using these routines, that the result still makes sense. Starting from a different set of parameters is highly recommended if the fit does not behave. If a maximum likelihood fit is having some issues, consider first doing a least-squares fit, which is a bit quicker and more robust, to estimate the starting parameters. Another issue is using large numbers for the frequency: best results are obtained of a deviation from a central frequency is used, so the frequency is kept in the few thousand MHz range.</p>
</div>
<div class="section" id="usage-examples">
<h2>Usage examples<a class="headerlink" href="#usage-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spectrum-creation">
<h3>Spectrum creation<a class="headerlink" href="#spectrum-creation" title="Permalink to this headline">¶</a></h3>
<p>Creating a simple hyperfinestructure uses the class <tt class="xref py py-class docutils literal"><span class="pre">SingleSpectrum</span></tt> from the <a class="reference internal" href="#module-spectrum" title="spectrum: Implementation of classes for the analysis of hyperfine structure spectra, including simultaneous fitting, various fitting routines and isomeric presence. (Windows)"><tt class="xref py py-mod docutils literal"><span class="pre">spectrum</span></tt></a> module. Fitting to a single dataset is also demonstrated.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">satlas.spectrum</span> <span class="kn">as</span> <span class="nn">hs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span>


<span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;ticks&#39;</span><span class="p">)</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s">&#39;colorblind&#39;</span><span class="p">)</span>
<span class="c"># Gather all information</span>
<span class="n">I</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">ABC</span> <span class="o">=</span> <span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="c"># Create the spectrum</span>
<span class="n">hfs</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">SingleSpectrum</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>
<span class="n">hfs</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="mi">200</span>

<span class="c"># Say which frequencies are scanned</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="c"># Generate the data, add some noise</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">hfs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c"># Fit to the generated data</span>
<span class="n">hfs</span><span class="o">.</span><span class="n">FitToSpectroscopicData</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="c"># Print the fit report</span>
<span class="n">hfs</span><span class="o">.</span><span class="n">DisplayFit</span><span class="p">()</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">hfs</span><span class="o">.</span><span class="n">seperateResponse</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c"># Plot the result</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">hfs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">r&#39;$\chi^2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (MHz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Counts&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Example of Maximum Likelihood Estimation (MLE) fitting,</span>
<span class="c"># along with error calculation using Monte Carlo walking.</span>
<span class="n">hfs</span><span class="o">.</span><span class="n">showAll</span> <span class="o">=</span> <span class="bp">True</span>  <span class="c"># Show all triangle plots</span>
<span class="n">hfs</span><span class="o">.</span><span class="n">LikelihoodSpectroscopicFit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                               <span class="n">walking</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>  <span class="c"># Perform the walk</span>
                               <span class="n">walkers</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c"># Number of walkers,</span>
                                             <span class="c"># see the emcee documentation for</span>
                                             <span class="c"># more on this</span>
                               <span class="n">nsteps</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>  <span class="c"># Number of steps for each walker</span>
                               <span class="n">burnin</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>  <span class="c"># Defines the percentage of burnin</span>
                               <span class="n">showTriangle</span><span class="o">=</span><span class="bp">True</span>  <span class="c"># Show an awesome result plot</span>
                               <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">hfs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;MLE&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./pyplots/SingleSpectrumExample.py">Source code</a>)</p>
<div class="figure">
<img alt="_images/SingleSpectrumExample_00.png" src="_images/SingleSpectrumExample_00.png" />
<p class="caption">(<a class="reference external" href="./pyplots/SingleSpectrumExample_00.png">png</a>, <a class="reference external" href="./pyplots/SingleSpectrumExample_00.hires.png">hires.png</a>, <a class="reference external" href="./pyplots/SingleSpectrumExample_00.pdf">pdf</a>)</p>
</div>
<div class="figure">
<img alt="_images/SingleSpectrumExample_01.png" src="_images/SingleSpectrumExample_01.png" />
<p class="caption">(<a class="reference external" href="./pyplots/SingleSpectrumExample_01.png">png</a>, <a class="reference external" href="./pyplots/SingleSpectrumExample_01.hires.png">hires.png</a>, <a class="reference external" href="./pyplots/SingleSpectrumExample_01.pdf">pdf</a>)</p>
</div>
<div class="figure">
<img alt="_images/SingleSpectrumExample_02.png" src="_images/SingleSpectrumExample_02.png" />
<p class="caption">(<a class="reference external" href="./pyplots/SingleSpectrumExample_02.png">png</a>, <a class="reference external" href="./pyplots/SingleSpectrumExample_02.hires.png">hires.png</a>, <a class="reference external" href="./pyplots/SingleSpectrumExample_02.pdf">pdf</a>)</p>
</div>
</div>
<div class="section" id="multiple-spectrum-fitting">
<h3>Multiple spectrum fitting<a class="headerlink" href="#multiple-spectrum-fitting" title="Permalink to this headline">¶</a></h3>
<div class="section" id="combination-of-single-spectra">
<h4>Combination of single spectra<a class="headerlink" href="#combination-of-single-spectra" title="Permalink to this headline">¶</a></h4>
<p>The creation of a <tt class="xref py py-class docutils literal"><span class="pre">CombinedSpectrum</span></tt> from <tt class="xref py py-class docutils literal"><span class="pre">SingleSpectra</span></tt> is demonstrated. Fitting to two datasets is also demonstrated.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">satlas.spectrum</span> <span class="kn">as</span> <span class="nn">hs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span>


<span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;ticks&#39;</span><span class="p">)</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s">&#39;colorblind&#39;</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">ABC</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">129.109</span><span class="p">,</span> <span class="o">-</span><span class="mf">1723.61</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="mf">2285.804947</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="n">varyDict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Bl&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;Bu&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;Cl&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;Cu&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>
<span class="n">spec1</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">SingleSpectrum</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s">&#39;voigt&#39;</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">,</span>
                          <span class="n">scale</span><span class="o">=</span><span class="mf">4000.0</span><span class="p">,</span> <span class="n">rAmp</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">spec1</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">spec1</span><span class="o">.</span><span class="n">setVary</span><span class="p">(</span><span class="n">varyDict</span><span class="p">)</span>

<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">spec1</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1000</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">spec1</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="n">spec1</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
<span class="n">ydata</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">ydata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">fwhm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="mf">4100.0</span>
<span class="n">spec2</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">SingleSpectrum</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s">&#39;voigt&#39;</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">,</span>
                          <span class="n">scale</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">rAmp</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">spec2</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="mi">400</span>

<span class="n">xdata2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">spec2</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1000</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">spec2</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ydata2</span> <span class="o">=</span> <span class="n">spec2</span><span class="p">(</span><span class="n">xdata2</span><span class="p">)</span>
<span class="n">ydata2</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ydata2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">ydata2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">spec2</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">spec1comb</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">CombinedSpectrum</span><span class="p">([</span><span class="n">spec1</span><span class="p">,</span> <span class="n">spec2</span><span class="p">])</span>

<span class="n">spec1comb</span><span class="o">.</span><span class="n">FitToSpectroscopicData</span><span class="p">([</span><span class="n">xdata</span><span class="p">,</span> <span class="n">xdata2</span><span class="p">],</span> <span class="p">[</span><span class="n">ydata</span><span class="p">,</span> <span class="n">ydata2</span><span class="p">])</span>
<span class="n">spec1comb</span><span class="o">.</span><span class="n">DisplayFit</span><span class="p">(</span><span class="n">show_correl</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">eval1</span><span class="p">,</span> <span class="n">eval2</span> <span class="o">=</span> <span class="n">spec1comb</span><span class="o">.</span><span class="n">seperateResponse</span><span class="p">([</span><span class="n">xdata</span><span class="p">,</span> <span class="n">xdata2</span><span class="p">])</span>

<span class="n">xdata3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="o">-</span><span class="mi">4500</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">xdata3</span> <span class="o">=</span> <span class="p">[</span><span class="n">xdata3</span><span class="p">,</span> <span class="n">xdata3</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">spec1comb</span><span class="p">(</span><span class="n">xdata3</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">spec1comb</span><span class="o">.</span><span class="n">sanitizeFitInput</span><span class="p">(</span><span class="n">xdata3</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y2</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">eval1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata2</span><span class="p">,</span> <span class="n">ydata2</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata2</span><span class="p">,</span> <span class="n">eval2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (MHz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Counts&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">seaborn</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./pyplots/CombinedSingleSpectrum.py">Source code</a>, <a class="reference external" href="./pyplots/CombinedSingleSpectrum.png">png</a>, <a class="reference external" href="./pyplots/CombinedSingleSpectrum.hires.png">hires.png</a>, <a class="reference external" href="./pyplots/CombinedSingleSpectrum.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/CombinedSingleSpectrum.png" src="_images/CombinedSingleSpectrum.png" />
</div>
</div>
<div class="section" id="combination-of-spectra-with-isomeric-presence">
<h4>Combination of spectra with isomeric presence<a class="headerlink" href="#combination-of-spectra-with-isomeric-presence" title="Permalink to this headline">¶</a></h4>
<p>Adding in isomeric peaks complicates the spectrum</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">satlas.spectrum</span> <span class="kn">as</span> <span class="nn">hs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span>


<span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">&#39;ticks&#39;</span><span class="p">)</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s">&#39;colorblind&#39;</span><span class="p">)</span>

<span class="n">varyDict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Bl&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;Bu&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;Cl&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;Cu&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>

<span class="c"># Gather all information</span>
<span class="n">I</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">ABC</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">129.109</span><span class="p">,</span> <span class="o">-</span><span class="mf">1723.61</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="mf">2285.804947</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="c"># Create the spectrum</span>
<span class="n">spec1</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">SingleSpectrum</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s">&#39;voigt&#39;</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">,</span>
                          <span class="n">scale</span><span class="o">=</span><span class="mf">4000.0</span><span class="p">,</span> <span class="n">rAmp</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Set a few parameters</span>
<span class="n">spec1</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="mi">300</span>
<span class="c"># Fix the B and C parameters for spec1</span>
<span class="n">spec1</span><span class="o">.</span><span class="n">setVary</span><span class="p">(</span><span class="n">varyDict</span><span class="p">)</span>

<span class="c"># Isomer adding</span>
<span class="n">I</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ABC</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">45.3133</span><span class="p">,</span> <span class="o">-</span><span class="mf">591.94</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="mf">2266.436463</span>
<span class="n">spec4</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">SingleSpectrum</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s">&#39;voigt&#39;</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">,</span>
                          <span class="n">scale</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span> <span class="n">rAmp</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">spec4</span><span class="o">.</span><span class="n">setVary</span><span class="p">(</span><span class="n">varyDict</span><span class="p">)</span>

<span class="n">first</span> <span class="o">=</span> <span class="n">spec1</span> <span class="o">+</span> <span class="n">spec4</span>
<span class="c"># Set the parameters to be shared between the spectra.</span>
<span class="n">first</span><span class="o">.</span><span class="n">shared</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;FWHM&#39;</span><span class="p">,</span> <span class="s">&#39;FWHML&#39;</span><span class="p">,</span> <span class="s">&#39;FWHMG&#39;</span><span class="p">]</span>

<span class="c"># Generate the data, add some white noise</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
<span class="n">ydata</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">ydata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">first</span><span class="o">.</span><span class="n">FitToSpectroscopicData</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
<span class="n">first</span><span class="o">.</span><span class="n">DisplayFit</span><span class="p">(</span><span class="n">show_correl</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">iso1</span><span class="p">,</span> <span class="n">iso2</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">seperateResponse</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>

<span class="c"># Plot the results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">first</span><span class="p">(</span><span class="n">xdata</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">iso1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">iso2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (MHz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;Counts&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">seaborn</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./pyplots/IsomerExample.py">Source code</a>, <a class="reference external" href="./pyplots/IsomerExample.png">png</a>, <a class="reference external" href="./pyplots/IsomerExample.hires.png">hires.png</a>, <a class="reference external" href="./pyplots/IsomerExample.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/IsomerExample.png" src="_images/IsomerExample.png" />
</div>
</div>
</div>
</div>
<div class="section" id="module-satlas.spectrum">
<span id="code-documentation"></span><h2>Code documentation<a class="headerlink" href="#module-satlas.spectrum" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-spectrum"></span><p><em>Module author: Wouter Gins &lt;<a class="reference external" href="mailto:wouter&#46;gins&#37;&#52;&#48;fys&#46;kuleuven&#46;be">wouter<span>&#46;</span>gins<span>&#64;</span>fys<span>&#46;</span>kuleuven<span>&#46;</span>be</a>&gt;</em></p>
<p><em>Module author: Ruben de Groote &lt;<a class="reference external" href="mailto:ruben&#46;degroote&#37;&#52;&#48;fys&#46;kuleuven&#46;be">ruben<span>&#46;</span>degroote<span>&#64;</span>fys<span>&#46;</span>kuleuven<span>&#46;</span>be</a>&gt;</em></p>
<dl class="class">
<dt id="satlas.spectrum.CombinedSpectrum">
<em class="property">class </em><tt class="descclassname">satlas.spectrum.</tt><tt class="descname">CombinedSpectrum</tt><big>(</big><em>spectra</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#CombinedSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.CombinedSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#satlas.spectrum.Spectrum" title="satlas.spectrum.Spectrum"><tt class="xref py py-class docutils literal"><span class="pre">satlas.spectrum.Spectrum</span></tt></a></p>
<p>A class for combining different spectra (<tt class="xref py py-class docutils literal"><span class="pre">CombinedSpectrum</span></tt>) or
combining isomers/isotopes (<tt class="xref py py-class docutils literal"><span class="pre">IsomerSpectrum</span></tt>, child class).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>spectra</strong> (list of <tt class="xref py py-class docutils literal"><span class="pre">IsomerSpectrum</span></tt> or <tt class="xref py py-class docutils literal"><span class="pre">SingleSpectrum</span></tt> objects) &#8211; A list defining the different spectra.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="satlas.spectrum.CombinedSpectrum.lnprior">
<tt class="descname">lnprior</tt><big>(</big><em>params</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#CombinedSpectrum.lnprior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.CombinedSpectrum.lnprior" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the (uninformative) prior for all parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> (<em>Parameters</em>) &#8211; Instance of Parameters with values to be used in the fit/walk</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">If any of the parameters are out of bounds, returns <tt class="xref py py-data docutils literal"><span class="pre">-np.inf</span></tt>
, otherwise 1.0 is returned</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.CombinedSpectrum.paramsFromVar">
<tt class="descname">paramsFromVar</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#CombinedSpectrum.paramsFromVar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.CombinedSpectrum.paramsFromVar" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the parameters from the subspectra into one Parameters
instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>params</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Parameters instance describing the spectrum.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Black magic going on in here, especially in the block of code
describing the shared parameters.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.CombinedSpectrum.sanitizeFitInput">
<tt class="descname">sanitizeFitInput</tt><big>(</big><em>x</em>, <em>y</em>, <em>yerr=None</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#CombinedSpectrum.sanitizeFitInput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.CombinedSpectrum.sanitizeFitInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>, <tt class="xref py py-attr docutils literal"><span class="pre">y</span></tt>, and <tt class="xref py py-attr docutils literal"><span class="pre">yerr</span></tt> inputs, and sanitize
them for the fit, meaning it should convert <tt class="xref py py-attr docutils literal"><span class="pre">y</span></tt>/<tt class="xref py py-attr docutils literal"><span class="pre">yerr</span></tt> to
the output format of the class, and <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt> to the input format of
the class.</p>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.CombinedSpectrum.splitParams">
<tt class="descname">splitParams</tt><big>(</big><em>params</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#CombinedSpectrum.splitParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.CombinedSpectrum.splitParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to split the parameters of the IsomerSpectrum
instance into a list of parameters suitable for each subspectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> (<em>Parameters</em>) &#8211; Parameters of the <tt class="xref py py-class docutils literal"><span class="pre">IsomerSpectrum</span></tt> instance.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>p</strong> &#8211;
A list of Parameters instances, each entry corresponding to the
same entry in the attribute <tt class="xref py py-attr docutils literal"><span class="pre">spectra</span></tt>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of Parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.CombinedSpectrum.varFromParams">
<tt class="descname">varFromParams</tt><big>(</big><em>params</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#CombinedSpectrum.varFromParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.CombinedSpectrum.varFromParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a Parameters instance such as returned by the method
<tt class="xref py py-meth docutils literal"><span class="pre">paramsFromVar()</span></tt>, set the parameters of the subspectra to the
appropriate values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> (<em>Parameters</em>) &#8211; Parameters instance containing the information for the variables.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="satlas.spectrum.IsomerSpectrum">
<em class="property">class </em><tt class="descclassname">satlas.spectrum.</tt><tt class="descname">IsomerSpectrum</tt><big>(</big><em>spectra</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#IsomerSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.IsomerSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#satlas.spectrum.CombinedSpectrum" title="satlas.spectrum.CombinedSpectrum"><tt class="xref py py-class docutils literal"><span class="pre">satlas.spectrum.CombinedSpectrum</span></tt></a></p>
<p>Create a spectrum containing the information of multiple hyperfine
structures. Most common use will be to fit a spectrum containing an isomer,
hence the name of the class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>spectra</strong> (list of <tt class="xref py py-class docutils literal"><span class="pre">SingleSpectrum</span></tt> instances) &#8211; A list containing the base spectra</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="satlas.spectrum.IsomerSpectrum.paramsFromVar">
<tt class="descname">paramsFromVar</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#IsomerSpectrum.paramsFromVar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.IsomerSpectrum.paramsFromVar" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the parameters from the subspectra into one Parameters
instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>params</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Parameters instance describing the spectrum</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.IsomerSpectrum.sanitizeFitInput">
<tt class="descname">sanitizeFitInput</tt><big>(</big><em>x</em>, <em>y</em>, <em>yerr=None</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#IsomerSpectrum.sanitizeFitInput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.IsomerSpectrum.sanitizeFitInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Doesn&#8217;t do anything yet.</p>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.IsomerSpectrum.seperateResponse">
<tt class="descname">seperateResponse</tt><big>(</big><em>x</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#IsomerSpectrum.seperateResponse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.IsomerSpectrum.seperateResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the response for each seperate spectrum for the values x,
without background.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>float or array_like</em>) &#8211; Frequency in MHz.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Seperate responses of spectra to the input <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of floats or NumPy arrays</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.IsomerSpectrum.walk">
<tt class="descname">walk</tt><big>(</big><em>x</em>, <em>y</em>, <em>showLikeli=False</em>, <em>showWalks=False</em>, <em>showTriangle=False</em>, <em>nsteps=2000</em>, <em>walkers=40</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#IsomerSpectrum.walk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.IsomerSpectrum.walk" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the default number of walkers to 40, for the higher number
of parameters.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="satlas.spectrum.PriorParameter">
<em class="property">class </em><tt class="descclassname">satlas.spectrum.</tt><tt class="descname">PriorParameter</tt><big>(</big><em>name</em>, <em>value=None</em>, <em>vary=True</em>, <em>min=None</em>, <em>max=None</em>, <em>expr=None</em>, <em>priormin=None</em>, <em>priormax=None</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#PriorParameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.PriorParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">lmfit.parameter.Parameter</span></tt></p>
<p>Extended the Parameter class from LMFIT to incorporate prior boundaries.</p>
</dd></dl>

<dl class="class">
<dt id="satlas.spectrum.SingleSpectrum">
<em class="property">class </em><tt class="descclassname">satlas.spectrum.</tt><tt class="descname">SingleSpectrum</tt><big>(</big><em>I, J, ABC, df, fwhm=[50.0, 50.0], scale=1.0, background=0.0, shape='voigt', rAmp=True, sameFWHM=True</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#SingleSpectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.SingleSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#satlas.spectrum.Spectrum" title="satlas.spectrum.Spectrum"><tt class="xref py py-class docutils literal"><span class="pre">satlas.spectrum.Spectrum</span></tt></a></p>
<p>Class for the construction of a HFS spectrum, consisting of different
peaks described by a certain profile. The number of peaks and their
positions is governed by the atomic HFS.
Calling an instance of the Spectrum class returns the response value of the
HFS spectrum for that frequency in MHz.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>I</strong> (<em>float</em>) &#8211; The nuclear spin.</li>
<li><strong>J</strong> (<em>list of 2 floats</em>) &#8211; The spins of the fine structure levels.</li>
<li><strong>ABC</strong> (<em>list of 6 floats</em>) &#8211; The hyperfine structure constants A, B and C for ground- and excited
fine level. The list should be given as [A <sub>lower</sub>,
A <sub>upper</sub>, B <sub>lower</sub>, B <sub>upper</sub>, C <sub>upper</sub>,
C <sub>lower</sub>].</li>
<li><strong>df</strong> (<em>float</em>) &#8211; Center of Gravity of the spectrum.</li>
<li><strong>fwhm</strong> (<em>float or list of 2 floats, optional</em>) &#8211; Depending on the used shape, the FWHM is defined by one or two floats.
Defaults to [50.0, 50.0]</li>
<li><strong>scale</strong> (<em>float, optional</em>) &#8211; Sets the strength of the spectrum, defaults to 1.0. Comparable to the
amplitude of the spectrum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first last simple">
<li><strong>shape</strong> (<em>string, optional</em>) &#8211;
Sets the transition shape. String is converted to lowercase. For
possible values, see <tt class="xref py py-attr docutils literal"><span class="pre">Spectrum.__shapes__.keys()</span></tt>.
Defaults to Voigt if an incorrect value is supplied.</li>
<li><strong>rAmp</strong> (<em>Boolean, optional</em>) &#8211;
If True, fixes the relative peak intensities to the Racah intensities.
Otherwise, gives them equal intensities and allows them to vary during
fitting.</li>
<li><strong>sameFWHM</strong> (<em>Boolean, optional</em>) &#8211;
If True, the same FWHM is used for all peaks. Otherwise, give them all
the same initial FWHM and let them vary during the fitting.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="spectrum.SingleSpectrum.fwhm">
<tt class="descname">fwhm</tt><a class="headerlink" href="#spectrum.SingleSpectrum.fwhm" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(list of) float or list of 2 floats</em></p>
<p>Sets the FWHM for all the transtions. If <tt class="xref py py-attr docutils literal"><span class="pre">sameFWHM</span></tt> is True,
this attribute is a list of FWHM values for each peak.</p>
</dd></dl>

<dl class="attribute">
<dt id="spectrum.SingleSpectrum.relAmp">
<tt class="descname">relAmp</tt><a class="headerlink" href="#spectrum.SingleSpectrum.relAmp" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of floats</em></p>
<p>Sets the relative intensities of the transitions.</p>
</dd></dl>

<dl class="attribute">
<dt id="spectrum.SingleSpectrum.scale">
<tt class="descname">scale</tt><a class="headerlink" href="#spectrum.SingleSpectrum.scale" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Sets the amplitude of the global spectrum.</p>
</dd></dl>

<dl class="attribute">
<dt id="spectrum.SingleSpectrum.background">
<tt class="descname">background</tt><a class="headerlink" href="#spectrum.SingleSpectrum.background" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Sets the background of the global spectrum.</p>
</dd></dl>

<dl class="attribute">
<dt id="spectrum.SingleSpectrum.ABC">
<tt class="descname">ABC</tt><a class="headerlink" href="#spectrum.SingleSpectrum.ABC" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of 6 floats</em></p>
<p>List of the hyperfine structure constants, organised as
[A <sub>lower</sub>, A <sub>upper</sub>, B <sub>lower</sub>, B <sub>upper</sub>,
C <sub>upper</sub>, C <sub>lower</sub>].</p>
</dd></dl>

<dl class="attribute">
<dt id="spectrum.SingleSpectrum.n">
<tt class="descname">n</tt><a class="headerlink" href="#spectrum.SingleSpectrum.n" title="Permalink to this definition">¶</a></dt>
<dd><p><em>integer</em></p>
<p>Sets the number of Poisson sidepeaks.</p>
</dd></dl>

<dl class="attribute">
<dt id="spectrum.SingleSpectrum.offset">
<tt class="descname">offset</tt><a class="headerlink" href="#spectrum.SingleSpectrum.offset" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Sets the offset for the Poisson sidepeaks.
The sidepeaks are located at <img class="math" src="_images/math/d31ff1eda53c980f07a43419fbcec1b12cc629d8.png" alt="i\cdot \text{offset}"/>,
with <img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> the number of the sidepeak.
Note: this means that a negative value indicates a sidepeak
to the left of the main peak.</p>
</dd></dl>

<dl class="attribute">
<dt id="spectrum.SingleSpectrum.poisson">
<tt class="descname">poisson</tt><a class="headerlink" href="#spectrum.SingleSpectrum.poisson" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Sets the Poisson-factor for the Poisson sidepeaks.
The amplitude of each sidepeak is multiplied by
<img class="math" src="_images/math/9f41897c5a7ad005818f98cc4ac78c184122492e.png" alt="\text{poisson}^i/i!"/>, with <img class="math" src="_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> the number of the sidepeak.</p>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The listed attributes are commonly accessed attributes for the end user.
More are used, and should be looked up in the source code.</p>
</div>
<dl class="method">
<dt id="satlas.spectrum.SingleSpectrum.__add__">
<tt class="descname">__add__</tt><big>(</big><em>other</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#SingleSpectrum.__add__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.SingleSpectrum.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add two spectra together to get an <tt class="xref py py-class docutils literal"><span class="pre">IsomerSpectrum</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Spectrum</em>) &#8211; Other spectrum to add.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An Isomerspectrum combining both spectra.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">IsomerSpectrum</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.SingleSpectrum.__call__">
<tt class="descname">__call__</tt><big>(</big><em>x</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#SingleSpectrum.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.SingleSpectrum.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the response for frequency <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt> (in MHz) of the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>float or array_like</em>) &#8211; Frequency in MHz</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Response of the spectrum for each value of <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float or NumPy array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.SingleSpectrum.calculateEnergy">
<tt class="descname">calculateEnergy</tt><big>(</big><em>level</em>, <em>F</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#SingleSpectrum.calculateEnergy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.SingleSpectrum.calculateEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>The hyperfine addition to a central frequency (attribute <em>df</em>) for
a specific level is calculated. The formula used is</p>
<div class="math">
<p><img src="_images/math/728a256e650647a1c12d4730a1798fe55c17918c.png" alt="C_F &amp;= F(F+1) - I(I+1) - J(J+1)

D_F &amp;= \frac{3 C_F (C_F + 1) - 4 I (I + 1) J (J + 1)}{2 I (2 I - 1)
J (2 J - 1)}

E_F &amp;= \frac{10 (\frac{C_F}{2})^3 + 20(\frac{C_F}{2})^2 + C_F(-3I(I
+ 1)J(J + 1) + I(I + 1) + J(J + 1) + 3) - 5I(I + 1)J(J + 1)}{I(I -
1)(2I - 1)J(J - 1)(2J - 1)}

E &amp;= df + \frac{A C_F}{2} + \frac{B D_F}{4} + C E_F"/></p>
</div><p>A, B and C are the dipole, quadrupole and octupole hyperfine parameters.
Octupole contributions are calculated when both the nuclear and
electronic spin is greater than 1, quadrupole contributions when they
are greater than 1/2, and dipole contributions when they are greater
than 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>level</strong> (<em>int, 0 or 1</em>) &#8211; Integer referring to the lower (0) level, or the upper (1) level.</li>
<li><strong>F</strong> (<em>integer or half-integer</em>) &#8211; F-quantum number for which the hyperfine-corrected energy has to be
calculated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>energy</strong> &#8211;
Energy in MHz.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.SingleSpectrum.lnprior">
<tt class="descname">lnprior</tt><big>(</big><em>params</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#SingleSpectrum.lnprior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.SingleSpectrum.lnprior" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the (uninformative) prior for all parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> (<em>Parameters</em>) &#8211; Instance of Parameters with values to be used in the fit/walk</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">If any of the parameters are out of bounds, returns <tt class="xref py py-data docutils literal"><span class="pre">-np.inf</span></tt>
, otherwise 1.0 is returned</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.SingleSpectrum.paramsFromVar">
<tt class="descname">paramsFromVar</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#SingleSpectrum.paramsFromVar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.SingleSpectrum.paramsFromVar" title="Permalink to this definition">¶</a></dt>
<dd><p>Goes through all the relevant parameters of the spectrum,
and returns a Parameters instance containing all the information. User-
supplied information in the self._vary dictionary is used to set
the variation of parameters during the fitting, while
making sure that the A, B and C parameters are not used if the spins
do not allow it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Instance suitable for the method <tt class="xref py py-meth docutils literal"><span class="pre">varFromParams()</span></tt>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.SingleSpectrum.seperateResponse">
<tt class="descname">seperateResponse</tt><big>(</big><em>x</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#SingleSpectrum.seperateResponse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.SingleSpectrum.seperateResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the response for each seperate spectrum for the values <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>
, without background.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>float or array_like</em>) &#8211; Frequency in MHz.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Seperate responses of spectra to the input <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of floats or NumPy arrays</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.SingleSpectrum.setVary">
<tt class="descname">setVary</tt><big>(</big><em>varyDict</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#SingleSpectrum.setVary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.SingleSpectrum.setVary" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the variation of the fitparameters as supplied in the
dictionary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>varydict</strong> (<em>dictionary</em>) &#8211; A dictionary containing &#8216;key: True/False&#8217; mappings</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The list of usable keys:</p>
<ul class="last simple">
<li><tt class="xref py py-attr docutils literal"><span class="pre">FWHM</span></tt> (only for profiles with one float for the FWHM)</li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">eta</span></tt>  (only for the Pseudovoigt profile)</li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">FWHMG</span></tt> (only for profiles with two floats for the FWHM)</li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">FWHML</span></tt> (only for profiles with two floats for the FWHM)</li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">Al</span></tt></li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">Au</span></tt></li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">Bl</span></tt></li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">Bu</span></tt></li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">Cl</span></tt></li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">Cu</span></tt></li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">df</span></tt></li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">Background</span></tt></li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">Poisson</span></tt> (only if the attribute <em>n</em> is greater than 0)</li>
<li><tt class="xref py py-attr docutils literal"><span class="pre">Offset</span></tt> (only if the attribute <em>n</em> is greater than 0)</li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.SingleSpectrum.varFromParams">
<tt class="descname">varFromParams</tt><big>(</big><em>params</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#SingleSpectrum.varFromParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.SingleSpectrum.varFromParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a Parameters instance &#8216;params&#8217;, the value-fields for all the
parameters are extracted and used to set the values of the spectrum.
Will raise a KeyError exception if an unsuitable instance is
supplied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> (<em>Parameters</em>) &#8211; Instance of Parameters to set all values.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="satlas.spectrum.Spectrum">
<em class="property">class </em><tt class="descclassname">satlas.spectrum.</tt><tt class="descname">Spectrum</tt><a class="reference internal" href="_modules/satlas/spectrum.html#Spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.Spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">builtins.object</span></tt></p>
<p>Baseclass for all spectra, such as <tt class="xref py py-class docutils literal"><span class="pre">SingleSpectrum</span></tt>,
<tt class="xref py py-class docutils literal"><span class="pre">CombinedSpectrum</span></tt> and <tt class="xref py py-class docutils literal"><span class="pre">IsomerSpectrum</span></tt>. For input, see these
classes.</p>
<dl class="attribute">
<dt id="spectrum.Spectrum.selected">
<tt class="descname">selected</tt><a class="headerlink" href="#spectrum.Spectrum.selected" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of strings</em></p>
<p>When a walk is performed and a triangle plot is requested, the
parameters with one of these strings in their name will be displayed in
a seperate plot. Defaults to the hyperfine parameters and the centroid.</p>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.Spectrum.DisplayFit">
<tt class="descname">DisplayFit</tt><big>(</big><em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#Spectrum.DisplayFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.Spectrum.DisplayFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Display all relevent info of the least-squares fitting routine,
if this has been performed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> (<em>misc</em>) &#8211; Keywords passed on to <tt class="xref py py-func docutils literal"><span class="pre">fit_report()</span></tt> from the LMFit package.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.Spectrum.DisplayMLEFit">
<tt class="descname">DisplayMLEFit</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#Spectrum.DisplayMLEFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.Spectrum.DisplayMLEFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Give a readable overview of the result of the MLE fitting routine.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The uncertainty shown is the largest of the asymmetrical errors! Work
is being done to incorporate asymmetrical errors in the report; for
now, rely on the triangle plot.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.Spectrum.FitToData">
<tt class="descname">FitToData</tt><big>(</big><em>x</em>, <em>y</em>, <em>yerr</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#Spectrum.FitToData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.Spectrum.FitToData" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a non-linear least squares minimization (Levenberg-Marquardt)
algorithm to minimize the chi-square of the fit to data <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt> and
<tt class="xref py py-attr docutils literal"><span class="pre">y</span></tt> with errorbars <tt class="xref py py-attr docutils literal"><span class="pre">yerr</span></tt>. Reasonable bounds are used on
parameters, and the user-supplied <tt class="xref py py-attr docutils literal"><span class="pre">self._vary</span></tt> dictionary is
consulted to see if a parameter should be varied or not.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>array_like</em>) &#8211; Frequency of the data, in MHz.</li>
<li><strong>y</strong> (<em>array_like</em>) &#8211; Counts corresponding to <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>.</li>
<li><strong>yerr</strong> (<em>array_like</em>) &#8211; Error bars on <tt class="xref py py-attr docutils literal"><span class="pre">y</span></tt>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.Spectrum.FitToSpectroscopicData">
<tt class="descname">FitToSpectroscopicData</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#Spectrum.FitToSpectroscopicData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.Spectrum.FitToSpectroscopicData" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <tt class="xref py py-meth docutils literal"><span class="pre">FitToData()</span></tt> method, automatically estimating the errors
on the counts by the square root.</p>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.Spectrum.LikelihoodSpectroscopicFit">
<tt class="descname">LikelihoodSpectroscopicFit</tt><big>(</big><em>x</em>, <em>y</em>, <em>walking=True</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#Spectrum.LikelihoodSpectroscopicFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.Spectrum.LikelihoodSpectroscopicFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the spectrum to the spectroscopic data using the Maximum
Likelihood technique. This is done by minimizing the negative sum of
the loglikelihoods of the spectrum given the data (given by the method
<tt class="xref py py-meth docutils literal"><span class="pre">lnprob()</span></tt>). Prints a statement regarding the success of the
fitting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array_like</em>) &#8211; Frequency of the data, in MHz.</li>
<li><strong>y</strong> (<em>array_like</em>) &#8211; Counts corresponding to <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>.</li>
<li><strong>walking</strong> (<em>Boolean</em>) &#8211; Determines if a Monte Carlo walk is performed after the
minimization to determine the errorbars and distribution of the
parameters.</li>
<li><strong>kwargs</strong> (<em>misc</em>) &#8211; Keyword arguments passed on to the method <tt class="xref py py-meth docutils literal"><span class="pre">walk()</span></tt>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>tuple or</strong> &#8211;
If any kind of plot is requested, a tuple containing these figures
will be returned (see <tt class="xref py py-meth docutils literal"><span class="pre">walk()</span></tt> for more details). If no plot
is requested, returns the value <tt class="xref py py-class docutils literal"><span class="pre">None</span></tt>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">class:<cite>None</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.Spectrum.lnprob">
<tt class="descname">lnprob</tt><big>(</big><em>params</em>, <em>x</em>, <em>y</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#Spectrum.lnprob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.Spectrum.lnprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sum of the loglikelihoods given the parameters
<tt class="xref py py-attr docutils literal"><span class="pre">params</span></tt>, while also checking the prior first. If this prior
rejects the parameters, the parameters are not set for the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (<em>Parameters</em>) &#8211; Instance of Parameters for which the sum loglikelihood has to be
calculated.</li>
<li><strong>x</strong> (<em>array_like</em>) &#8211; Frequencies in MHz.</li>
<li><strong>y</strong> (<em>array_like</em>) &#8211; Counts corresponding to <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Sum of the loglikelihoods plus the result of the prior.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.Spectrum.loglikeli">
<tt class="descname">loglikeli</tt><big>(</big><em>params</em>, <em>x</em>, <em>y</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#Spectrum.loglikeli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.Spectrum.loglikeli" title="Permalink to this definition">¶</a></dt>
<dd><p>Assuming a Poisson-distribution for the error of the measurements,
returns the loglikelihoods for the given parameter dictionary &#8216;params&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>params</strong> (<em>Parameters</em>) &#8211; Instance of Parameters for which the loglikelihood has to be
determined.</li>
<li><strong>x</strong> (<em>array_like</em>) &#8211; Frequencies in MHz.</li>
<li><strong>y</strong> (<em>array_like</em>) &#8211; Counts corresponding to <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="satlas.spectrum.Spectrum.walk">
<tt class="descname">walk</tt><big>(</big><em>x</em>, <em>y</em>, <em>showLikeli=False</em>, <em>showWalks=False</em>, <em>showTriangle=False</em>, <em>nsteps=2000</em>, <em>walkers=20</em>, <em>burnin=10.0</em><big>)</big><a class="reference internal" href="_modules/satlas/spectrum.html#Spectrum.walk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.spectrum.Spectrum.walk" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a random walk in the parameter space to determine the
distribution for the best fit of the parameters.</p>
<p>A message is printed before and after the walk.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The errors calculated can be asymmetrical, but only the largest is
saved as the overal uncertainty. This is a known issue, and work is
being done to resolve this.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array_like</em>) &#8211; Frequency of the data, in MHz.</li>
<li><strong>y</strong> (<em>array_like</em>) &#8211; Counts corresponding to <tt class="xref py py-attr docutils literal"><span class="pre">x</span></tt>.</li>
<li><strong>showLikeli</strong> (<em>Boolean, optional</em>) &#8211; Set this to True if a plot depicting the 1D slice of the
loglikelihood function for each parameter has to be plotted.</li>
<li><strong>showWalks</strong> (<em>Boolean, optional</em>) &#8211; Set this to True if a plot depicting the random walk has to be
plotted.</li>
<li><strong>showTriangle</strong> (<em>Boolean, optional</em>) &#8211; Set this to True is a triangle plot depicting the distributions of
the parameters in the random walk has to be plotted. Two plots are
created if <tt class="xref py py-attr docutils literal"><span class="pre">showAll</span></tt> is set to True: one with all the
parameters, one with only the parameters as filtered using
<a class="reference internal" href="#spectrum.Spectrum.selected" title="spectrum.Spectrum.selected"><tt class="xref py py-attr docutils literal"><span class="pre">selected</span></tt></a>.</li>
<li><strong>nsteps</strong> (<em>int, optional</em>) &#8211; Number of steps to be taken, defaults to 2000.</li>
<li><strong>walkers</strong> (<em>int, optional</em>) &#8211; Number of walkers to be used, defaults to 20.</li>
<li><strong>burnin</strong> (<em>float, optional</em>) &#8211; Burn-in to be used for the walk. Expressed in percentage,
defaults to 10.0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>returnfigs</strong> &#8211;
If any plots have been made by setting booleans, the figure handles
are returned as a tuple, ordered as
<tt class="xref py py-attr docutils literal"><span class="pre">(Likelihood,</span> <span class="pre">walks,</span> <span class="pre">triangleComplete,</span> <span class="pre">triangleSelected)</span></tt>.
Plots that have not been requested are not added. If no plots have
been requested, returns an empty tuple.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="loglikelihood.html" class="btn btn-neutral float-right" title="loglikelihood – Calculation of loglikelihood for common distributions"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="profiles.html" class="btn btn-neutral" title="profiles – Implementation of lineshapes"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Wouter Gins.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>